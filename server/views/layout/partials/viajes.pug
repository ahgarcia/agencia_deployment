.row.proximos-viajes
    each viaje in viajes
        .col-md-6.col-lg-4.mb-4
            article.card(role="article", aria-label=`Viaje a ${viaje.titulo}`)
                //- Imagen con atribución
                .imagen-viaje
                    img.img-fluid(
                        src=viaje.imagen,
                        alt=viaje.imagenData ? viaje.imagenData.altDescription : `Destino turístico: ${viaje.titulo}`,
                        loading="lazy",
                        width="400",
                        height="300",
                        style=viaje.imagenData && viaje.imagenData.color ? `background-color: ${viaje.imagenData.color}` : '',
                        onerror="if(this.src!='/img/destinos_grecia.jpg'){this.src='/img/destinos_grecia.jpg'}"
                    )

                    //- Badges de estado
                    - var disponiblesNum = parseInt(viaje.disponibles)
                    .trip-badges
                        if disponiblesNum <= 5 && disponiblesNum > 0
                            span.trip-badge.badge-warning-custom
                                | ¡#{viaje.disponibles} lugares!

                    //- Atribución del fotógrafo (requerido por Unsplash)
                    if viaje.imagenData && viaje.imagenData.photographer !== 'Escápate Conmigo'
                        .image-credit
                            small
                                | Foto por
                                a(href=viaje.imagenData.photographerUrl, target="_blank", rel="noopener noreferrer")
                                    = viaje.imagenData.photographer
                                |  en
                                a(href="https://unsplash.com", target="_blank", rel="noopener noreferrer") Unsplash

                .card-body
                    h2.h4= viaje.titulo
                    p
                        i.fas.fa-calendar-alt(aria-hidden="true")
                        span.sr-only Fechas:
                        |  #{viaje.fecha_ida} - #{viaje.fecha_vuelta}
                    p
                        i.fas.fa-dollar-sign(aria-hidden="true")
                        span.sr-only Precio:
                        |  #{viaje.precio}
                    - var descripcionCorta = viaje.descripcion.length > 120 ? viaje.descripcion.substr(0, 120) + '...' : viaje.descripcion
                    p.card-text= descripcionCorta
                    a(
                        href=`viajes/${viaje.id}`,
                        class="btn btn-success btn-block",
                        aria-label=`Ver más información sobre viaje a ${viaje.titulo}`
                    ) Más Información
