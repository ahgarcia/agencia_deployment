extends ../layout/index

block contenido
    main.container.my-5(role="main")
        .row.mb-4
            .col-12
                h1.display-4.text-center.mb-3= pagina
                p.lead.text-center.text-muted Descubre consejos de viaje, destinos increíbles y experiencias únicas

        //- Filtros por categoría
        .row.mb-4
            .col-12
                .blog-filters.d-flex.flex-wrap.justify-content-center
                    a.btn.btn-filter(href="/blog" class=categoriaActual ? '' : 'active') Todos
                    a.btn.btn-filter(href="/blog?categoria=consejos" class=categoriaActual === 'consejos' ? 'active' : '') Consejos
                    a.btn.btn-filter(href="/blog?categoria=destinos" class=categoriaActual === 'destinos' ? 'active' : '') Destinos
                    a.btn.btn-filter(href="/blog?categoria=experiencias" class=categoriaActual === 'experiencias' ? 'active' : '') Experiencias
                    a.btn.btn-filter(href="/blog?categoria=guias" class=categoriaActual === 'guias' ? 'active' : '') Guías
                    a.btn.btn-filter(href="/blog?categoria=noticias" class=categoriaActual === 'noticias' ? 'active' : '') Noticias

        .row
            //- Columna principal con posts
            .col-lg-8
                if posts && posts.length > 0
                    .row
                        each post in posts
                            .col-md-6.mb-4
                                article.card.h-100.shadow-sm.blog-card(itemscope itemtype="http://schema.org/BlogPosting")
                                    if post.imagen
                                        img.card-img-top(
                                            src=post.imagen
                                            alt=post.titulo
                                            loading="lazy"
                                            itemprop="image"
                                        )
                                    else
                                        .card-img-top.bg-gradient-primary.d-flex.align-items-center.justify-content-center(style="height: 200px;")
                                            i.fas.fa-newspaper.fa-3x.text-white
                                    .card-body.d-flex.flex-column
                                        .mb-2
                                            span.badge.badge-primary.mr-2= post.categoria
                                            small.text-muted
                                                i.far.fa-calendar-alt.mr-1
                                                time(datetime=post.fecha_publicacion itemprop="datePublished")= new Date(post.fecha_publicacion).toLocaleDateString('es-MX', { day: 'numeric', month: 'long', year: 'numeric' })
                                        h3.card-title.h5(itemprop="headline")
                                            a.text-dark(href=`/blog/${post.slug}`)= post.titulo
                                        p.card-text.text-muted(itemprop="description")= post.resumen
                                        .mt-auto.d-flex.justify-content-between.align-items-center
                                            a.btn.btn-outline-success(href=`/blog/${post.slug}` aria-label=`Leer más sobre ${post.titulo}`)
                                                | Leer más
                                                i.fas.fa-arrow-right.ml-1
                                            small.text-muted
                                                i.fas.fa-eye.mr-1
                                                span= post.vistas || 0
                else
                    .col-12
                        .alert.alert-info.text-center(role="alert")
                            i.fas.fa-info-circle.mr-2
                            | No hay artículos disponibles en esta categoría.

                //- Paginación
                if totalPages > 1
                    nav.mt-4(aria-label="Paginación del blog")
                        ul.pagination.justify-content-center
                            //- Botón anterior
                            li.page-item(class=currentPage === 1 ? 'disabled' : '')
                                a.page-link(href=`/blog?page=${currentPage - 1}${categoriaActual ? '&categoria=' + categoriaActual : ''}` aria-label="Anterior")
                                    span(aria-hidden="true") &laquo;

                            //- Números de página
                            - var startPage = Math.max(1, currentPage - 2)
                            - var endPage = Math.min(totalPages, currentPage + 2)

                            if startPage > 1
                                li.page-item
                                    a.page-link(href=`/blog?page=1${categoriaActual ? '&categoria=' + categoriaActual : ''}`) 1
                                if startPage > 2
                                    li.page-item.disabled
                                        span.page-link ...

                            - for (var i = startPage; i <= endPage; i++)
                                li.page-item(class=i === currentPage ? 'active' : '')
                                    a.page-link(href=`/blog?page=${i}${categoriaActual ? '&categoria=' + categoriaActual : ''}`)= i

                            if endPage < totalPages
                                if endPage < totalPages - 1
                                    li.page-item.disabled
                                        span.page-link ...
                                li.page-item
                                    a.page-link(href=`/blog?page=${totalPages}${categoriaActual ? '&categoria=' + categoriaActual : ''}`)= totalPages

                            //- Botón siguiente
                            li.page-item(class=currentPage === totalPages ? 'disabled' : '')
                                a.page-link(href=`/blog?page=${currentPage + 1}${categoriaActual ? '&categoria=' + categoriaActual : ''}` aria-label="Siguiente")
                                    span(aria-hidden="true") &raquo;

            //- Sidebar
            .col-lg-4
                //- Posts destacados
                if postsDestacados && postsDestacados.length > 0
                    .card.mb-4.shadow-sm.blog-sidebar-card
                        .card-header.blog-sidebar-header-pink
                            h4.mb-0.h5
                                i.fas.fa-fire.mr-2
                                | Más Leídos
                        .card-body.p-0
                            .list-group.list-group-flush
                                each post in postsDestacados
                                    a.list-group-item.list-group-item-action.blog-sidebar-item(href=`/blog/${post.slug}`)
                                        h5.mb-1.h6= post.titulo
                                        small.text-muted
                                            i.fas.fa-eye.mr-1
                                            span= post.vistas || 0
                                            |  vistas

                //- Categorías
                .card.shadow-sm.blog-sidebar-card
                    .card-header.blog-sidebar-header-turquoise
                        h4.mb-0.h5
                            i.fas.fa-folder.mr-2
                            | Categorías
                    .card-body
                        .list-group.list-group-flush
                            a.list-group-item.list-group-item-action.blog-sidebar-item.d-flex.justify-content-between.align-items-center(href="/blog?categoria=consejos")
                                span
                                    i.fas.fa-lightbulb.mr-2
                                    | Consejos
                            a.list-group-item.list-group-item-action.blog-sidebar-item.d-flex.justify-content-between.align-items-center(href="/blog?categoria=destinos")
                                span
                                    i.fas.fa-map-marked-alt.mr-2
                                    | Destinos
                            a.list-group-item.list-group-item-action.blog-sidebar-item.d-flex.justify-content-between.align-items-center(href="/blog?categoria=experiencias")
                                span
                                    i.fas.fa-star.mr-2
                                    | Experiencias
                            a.list-group-item.list-group-item-action.blog-sidebar-item.d-flex.justify-content-between.align-items-center(href="/blog?categoria=guias")
                                span
                                    i.fas.fa-book.mr-2
                                    | Guías
                            a.list-group-item.list-group-item-action.blog-sidebar-item.d-flex.justify-content-between.align-items-center(href="/blog?categoria=noticias")
                                span
                                    i.fas.fa-newspaper.mr-2
                                    | Noticias
