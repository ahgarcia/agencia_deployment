extends ../layout/index
block contenido
    main.container.mt-5
        //- Breadcrumbs
        nav(aria-label="Breadcrumb")
            ol.breadcrumb
                li.breadcrumb-item
                    a(href="/") Inicio
                li.breadcrumb-item
                    a(href="/viajes") Viajes
                li.breadcrumb-item.active(aria-current="page")= viaje.titulo

        //- Imagen principal con atribución
        .row.mb-4
            .col-12
                .imagen-viaje-detalle
                    img.img-fluid(
                        src=viaje.imagen,
                        alt=viaje.imagenData ? viaje.imagenData.altDescription : viaje.titulo,
                        style=viaje.imagenData && viaje.imagenData.color ? `background-color: ${viaje.imagenData.color}` : '',
                        onerror="if(this.src!='/img/destinos_grecia.jpg'){this.src='/img/destinos_grecia.jpg'}"
                    )

                    //- Atribución del fotógrafo
                    if viaje.imagenData && viaje.imagenData.photographer !== 'Escápate Conmigo'
                        .image-credit-detalle
                            small
                                | Foto por
                                a(href=viaje.imagenData.photographerUrl, target="_blank", rel="noopener noreferrer")
                                    = viaje.imagenData.photographer
                                |  en
                                a(href="https://unsplash.com", target="_blank", rel="noopener noreferrer") Unsplash

        //- Contenido principal
        .row
            //- Columna izquierda: Información del viaje
            .col-lg-8.mb-4
                //- Título y descripción
                h1.viaje-titulo #{viaje.titulo}
                p.viaje-descripcion.lead= viaje.descripcion

                //- Información rápida en cards
                .info-rapida.mt-4
                    .row
                        .col-6.col-md-3.mb-3
                            .info-card.text-center
                                .info-icon
                                    i.fas.fa-calendar-alt.fa-2x
                                small.d-block.text-muted.mt-2 Salida
                                strong.d-block.mt-1= viaje.fecha_ida

                        .col-6.col-md-3.mb-3
                            .info-card.text-center
                                .info-icon
                                    i.fas.fa-calendar-check.fa-2x
                                small.d-block.text-muted.mt-2 Regreso
                                strong.d-block.mt-1= viaje.fecha_vuelta

                        .col-6.col-md-3.mb-3
                            .info-card.text-center
                                .info-icon
                                    i.fas.fa-users.fa-2x
                                small.d-block.text-muted.mt-2 Disponibles
                                strong.d-block.mt-1(class=viaje.disponibles <= 5 ? 'text-danger' : '')
                                    = viaje.disponibles
                                    |  #{viaje.disponibles === 1 ? 'lugar' : 'lugares'}

                        .col-6.col-md-3.mb-3
                            .info-card.text-center
                                .info-icon
                                    i.fas.fa-tag.fa-2x
                                small.d-block.text-muted.mt-2 Precio
                                strong.d-block.mt-1.precio-destacado= viaje.precio

            //- Columna derecha: CTA Box y Galería
            .col-lg-4
                //- CTA Box (Call to Action)
                .cta-box
                    .price-box.text-center
                        h3 #{viaje.precio}
                        small por persona

                    if viaje.disponibles > 0
                        if viaje.disponibles <= 5
                            .urgency-badge
                                i.fas.fa-exclamation-triangle
                                | ¡Solo #{viaje.disponibles === 1 ? 'queda 1 lugar' : `quedan ${viaje.disponibles} lugares`}!

                        button.btn.btn-lg.btn-primary.btn-block(type="button")
                            i.fas.fa-calendar-check
                            |  Reservar Ahora

                        button.btn.btn-lg.btn-outline-secondary.btn-block(type="button")
                            i.fas.fa-envelope
                            |  Consultar Disponibilidad
                    else
                        .alert.alert-danger
                            strong Agotado
                            p Este viaje no tiene lugares disponibles

                //- Galería adicional (en sidebar)
                if viaje.galeria && viaje.galeria.length > 0
                    .galeria-sidebar.mt-4
                        h4.galeria-titulo
                            i.fas.fa-images.mr-2
                            | Más imágenes
                        .galeria-grid
                            each imagen, index in viaje.galeria.slice(0, 4)
                                .galeria-item
                                    img(
                                        src=imagen.urlSmall,
                                        alt=`Vista ${index + 1} de ${viaje.titulo}`,
                                        loading="lazy"
                                    )
                                    .galeria-overlay
                                        i.fas.fa-search-plus

        //- Sección "Qué Incluye / No Incluye"
        .row.mt-5
            .col-12
                h2.seccion-titulo.text-center.mb-4
                    i.fas.fa-info-circle.mr-2
                    | Detalles del paquete

            .col-md-6.mb-4.mb-md-0
                .card.incluye-card.h-100
                    .card-body
                        h3.card-title
                            i.fas.fa-check-circle.mr-2
                            | Qué incluye
                        ul.list-unstyled.mt-3
                            each item in incluye
                                li.incluye-item
                                    .item-icon
                                        i.fas(class=item.icono)
                                    .item-text= item.texto

            .col-md-6
                .card.no-incluye-card.h-100
                    .card-body
                        h3.card-title
                            i.fas.fa-times-circle.mr-2
                            | No incluye
                        ul.list-unstyled.mt-3
                            each item in noIncluye
                                li.no-incluye-item
                                    .item-icon
                                        i.fas(class=item.icono)
                                    .item-text= item.texto
