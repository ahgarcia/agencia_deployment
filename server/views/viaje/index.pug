extends ../layout/index
block contenido
    main.container.mt-5
        //- Breadcrumbs
        nav(aria-label="Breadcrumb")
            ol.breadcrumb
                li.breadcrumb-item
                    a(href="/") Inicio
                li.breadcrumb-item
                    a(href="/viajes") Viajes
                li.breadcrumb-item.active(aria-current="page")= viaje.titulo

        //- Imagen principal con atribución
        .row.mb-4
            .col-12
                .imagen-viaje-detalle
                    img.img-fluid(
                        src=viaje.imagen,
                        alt=viaje.imagenData ? viaje.imagenData.altDescription : viaje.titulo,
                        style=viaje.imagenData && viaje.imagenData.color ? `background-color: ${viaje.imagenData.color}` : '',
                        onerror="if(this.src!='/img/destinos_grecia.jpg'){this.src='/img/destinos_grecia.jpg'}"
                    )

                    //- Atribución del fotógrafo
                    if viaje.imagenData && viaje.imagenData.photographer !== 'Escápate Conmigo'
                        .image-credit-detalle
                            small
                                | Foto por
                                a(href=viaje.imagenData.photographerUrl, target="_blank", rel="noopener noreferrer")
                                    = viaje.imagenData.photographer
                                |  en
                                a(href="https://unsplash.com", target="_blank", rel="noopener noreferrer") Unsplash

        //- Información del viaje
        .row
            .col-md-7
                h1 #{viaje.titulo}
                p= viaje.descripcion

                .detalles-viaje.mt-4
                    p
                        i.fas.fa-calendar-alt
                        |  Fecha Ida: #{viaje.fecha_ida}
                    p
                        i.fas.fa-calendar-alt
                        |  Fecha Vuelta: #{viaje.fecha_vuelta}
                    p
                        i.fas.fa-dollar-sign
                        |  Precio: #{viaje.precio}
                    p
                        i.fas.fa-users
                        |  Lugares Disponibles: #{viaje.disponibles}

            .col-md-5
                //- CTA Box (Call to Action)
                - var disponiblesNum = parseInt(viaje.disponibles)
                .cta-box
                    .price-box.text-center
                        h3 #{viaje.precio}
                        small por persona

                    if disponiblesNum > 0
                        if disponiblesNum <= 5
                            .urgency-badge
                                i.fas.fa-exclamation-triangle
                                | ¡Solo quedan #{viaje.disponibles} lugares!

                        button.btn.btn-lg.btn-primary.btn-block(type="button")
                            i.fas.fa-calendar-check
                            |  Reservar Ahora

                        button.btn.btn-lg.btn-outline-secondary.btn-block(type="button")
                            i.fas.fa-envelope
                            |  Consultar Disponibilidad
                    else
                        .alert.alert-danger
                            strong Agotado
                            p Este viaje no tiene lugares disponibles

                //- Galería adicional
                if viaje.galeria && viaje.galeria.length > 0
                    .galeria-adicional.mt-4
                        h3 Más imágenes de este destino
                        .row-galeria
                            each imagen in viaje.galeria
                                .col-galeria
                                    img(
                                        src=imagen.urlSmall,
                                        alt=`Vista de ${viaje.titulo}`,
                                        loading="lazy"
                                    )
                                    if imagen.photographer
                                        small.text-muted
                                            | Por
                                            a(href=imagen.photographerUrl, target="_blank", rel="noopener noreferrer")
                                                = imagen.photographer
